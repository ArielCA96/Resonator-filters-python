def CstDefineFrequencyDomainSolver(mws, startFreq, endFreq, samples, SourceType):
    #changeSolverType = mws.ChangeSolverType('HF Frequency Domain')


    sCommand = f"""
            'set the solver type
            ChangeSolverType("HF Frequency Domain")
            """
    mws._FlagAsMethod("AddToHistory")
    mws.AddToHistory('Change Solver Type', sCommand)

    mesh = mws.Mesh
    fdSolver = mws.FDSolver
    ieSolver = mws.IESolver

    mesh.SetCreator('High Frequency')

    fdSolver.Reset()
    fdSolver.SetMethod('Tetrahedral', 'General purpose')
    fdSolver.OrderTet('Second')
    fdSolver.OrderSrf('First')
    fdSolver.Stimulation(SourceType, 'All')
    fdSolver.ResetExcitationList()
    fdSolver.AutoNormImpedance('False')
    fdSolver.NormingImpedance('50')
    fdSolver.ModesOnly('False')
    fdSolver.ConsiderPortLossesTet('True')
    fdSolver.SetShieldAllPorts('False')
    fdSolver.AccuracyHex('1e-6')
    fdSolver.AccuracyTet('1e-4')
    fdSolver.AccuracySrf('1e-3')
    fdSolver.LimitIterations('False')
    fdSolver.MaxIterations('0')
    fdSolver.SetCalcBlockExcitationsInParallel('True', 'True', '')
    fdSolver.StoreAllResults('False')
    fdSolver.StoreResultsInCache('False')
    fdSolver.UseHelmholtzEquation('True')
    fdSolver.LowFrequencyStabilization('True')
    fdSolver.Type('Auto')
    fdSolver.MeshAdaptionHex('False')
    fdSolver.MeshAdaptionTet('True')
    fdSolver.AcceleratedRestart('True')
    fdSolver.FreqDistAdaptMode('Distributed')
    fdSolver.NewIterativeSolver('True')
    fdSolver.TDCompatibleMaterials('False')
    fdSolver.ExtrudeOpenBC('True')
    fdSolver.SetOpenBCTypeHex('Default')
    fdSolver.SetOpenBCTypeTet('Default')
    fdSolver.AddMonitorSamples('True')
    fdSolver.CalcPowerLoss('True')
    fdSolver.CalcPowerLossPerComponent('False')
    fdSolver.StoreSolutionCoefficients('True')
    fdSolver.UseDoublePrecision('False')
    fdSolver.UseDoublePrecision_ML('True')
    fdSolver.MixedOrderSrf('False')
    fdSolver.MixedOrderTet('False')
    fdSolver.PreconditionerAccuracyIntEq('0.15')
    fdSolver.MLFMMAccuracy('Default')
    fdSolver.MinMLFMMBoxSize('0.3')
    fdSolver.UseCFIEForCPECIntEq('True')
    fdSolver.UseEnhancedCFIE2('True')
    fdSolver.UseFastRCSSweepIntEq('False')
    fdSolver.UseSensitivityAnalysis('False')
    fdSolver.UseEnhancedNFSImprint('False')
    fdSolver.RemoveAllStopCriteria('Hex')
    fdSolver.AddStopCriterion('All S-Parameters', '0.01', '2', 'Hex', 'True')
    fdSolver.AddStopCriterion('Reflection S-Parameters', '0.01', '2', 'Hex', 'False')
    fdSolver.AddStopCriterion('Transmission S-Parameters', '0.01', '2', 'Hex', 'False')
    fdSolver.RemoveAllStopCriteria('Tet')
    fdSolver.AddStopCriterion('All S-Parameters', '0.01', '2', 'Tet', 'True')
    fdSolver.AddStopCriterion('Reflection S-Parameters', '0.01', '2', 'Tet', 'False')
    fdSolver.AddStopCriterion('Transmission S-Parameters', '0.01', '2', 'Tet', 'False')
    fdSolver.AddStopCriterion('All Probes', '0.05', '2', 'Tet', 'True')
    fdSolver.RemoveAllStopCriteria('Srf')
    fdSolver.AddStopCriterion('All S-Parameters', '0.01', '2', 'Srf', 'True')
    fdSolver.AddStopCriterion('Reflection S-Parameters', '0.01', '2', 'Srf', 'False')
    fdSolver.AddStopCriterion('Transmission S-Parameters', '0.01', '2', 'Srf', 'False')
    fdSolver.SweepMinimumSamples('3')
    fdSolver.SetNumberOfResultDataSamples('1001')
    fdSolver.SetResultDataSamplingMode('Automatic')
    fdSolver.SweepWeightEvanescent('1.0')
    fdSolver.AccuracyROM('1e-4')
    fdSolver.AddSampleInterval(str(startFreq), str(endFreq), str(samples), 'Automatic', 'True')
    fdSolver.AddSampleInterval('', '', '', 'Automatic', 'False')
    fdSolver.MPIParallelization('False')
    fdSolver.UseDistributedComputing('False')
    fdSolver.NetworkComputingStrategy('RunRemote')
    fdSolver.NetworkComputingJobCount('3')
    fdSolver.UseParallelization('True')
    fdSolver.MaxCPUs('1024')
    fdSolver.MaximumNumberOfCPUDevices('2')

    ieSolver.Reset()
    ieSolver.UseFastFrequencySweep('True')
    ieSolver.UseIEGroundPlane('False')
    ieSolver.SetRealGroundMaterialName('')
    ieSolver.CalcFarFieldInRealGround('False')
    ieSolver.RealGroundModelType('Auto')
    ieSolver.PreconditionerType('Auto')
    ieSolver.ExtendThinWireModelByWireNubs('False')
    ieSolver.ExtraPreconditioning('False')

    ieSolver.SetFMMFFCalcStopLevel('0')
    ieSolver.SetFMMFFCalcNumInterpPoints('6')
    ieSolver.UseFMMFarfieldCalc('True')
    ieSolver.SetCFIEAlpha('0.500000')
    ieSolver.LowFrequencyStabilization('False')
    ieSolver.LowFrequencyStabilizationML('True')
    ieSolver.Multilayer('False')
    ieSolver.SetiMoMACC_I('0.0001')
    ieSolver.SetiMoMACC_M('0.0001')
    ieSolver.DeembedExternalPorts('True')
    ieSolver.SetOpenBC_XY('True')
    ieSolver.OldRCSSweepDefintion('False')
    ieSolver.SetRCSOptimizationProperties('True', '100', '0.00001')
    ieSolver.SetAccuracySetting('Custom')
    ieSolver.CalculateSParaforFieldsources('True')
    ieSolver.ModeTrackingCMA('True')
    ieSolver.NumberOfModesCMA('3')
    ieSolver.StartFrequencyCMA('-1.0')
    ieSolver.SetAccuracySettingCMA('Default')
    ieSolver.FrequencySamplesCMA('0')
    ieSolver.SetMemSettingCMA('Auto')
    ieSolver.CalculateModalWeightingCoefficientsCMA('True')
    ieSolver.DetectThinDielectrics('True')

    #mws.addToHistory('define frequency domain solver', 'VBA code executed')